  PROGRAM ARABESQUE;
{ FIGURE (13) - DIFFERENTIAL POINTS AROUND A CIRCLE X-STEP MODULUS }
{ COPYRIGHT 5/25/80 BY JOHN WHITNEY - PREPARED BY PAUL ROTHER }
{ ADAPTED FOR APPLE - II }
{ TRANSCRIBED FROM THE PRINTED EDITION BY JIM BUMGARDNER 10/2/2011 }

CONST DEG=0.0174533;            { CONVERTS DEGREE TO RADIAN }

VAR TIME,STEP,
    STEPSTART,STEPEND,
    A,X,Y,R,
    RADIUS,XCENTER,YCENTER  :REAL;

(*$IAPPLEDRV.TXT*)              { INCLUDE APPLE GRAPHICS DRIVER }

BEGIN

  NPOINTS     :=60;             { NUMBER OF POINTS IN A DISPLAY }
  NFRAMES     := 9;             { NUMBER OF FRAMES FOR THIS RUN }
  STEPSTART   := 0;             { STEP AT THE FIRST FRAME }
  STEPEND     :=1/60;           { STEP AT THE LAST FRAME }
  
  RADIUS      := 85;            { RADIUS }
  XCENTER     := 140;           { X CENTER }
  YCENTER     := 96;            { Y CENTER }
  
  FOR FRAME:=1 TO NFRAMES DO 
    BEGIN
  
      ERASE;
      
      TIME:=( FRAME-1 ) / ( NFRAMES-1 );
      STEP:= STEPSTART + ( TIME * ( STEPEND - STEPSTART ));
                                { STEP IN OVERALL CYCLE ( 1=FULL CYCLE ) }
      
      FOR POINT:= 1 TO NPOINTS DO 
        BEGIN
          A:= -90 + 360 * POINT / NPOINTS;

          R:= 3 * RADIUS ;
          X:= COS(A*DEG) * RADIUS + POINT * STEP * R ;
          X:= XCENTER - (R/2) + ( ROUND(X+(R/2)) MOD ROUND(R) );

          Y:= YCENTER + SIN(A*DEG) * RADIUS ;

          DRAWXY( ROUND(X) , ROUND(Y) );
        END;

      CAMERA(120);              { EXPOSE ONE FRAME }
      
    END
  READLN;                       { WAIT FOR USER RESPONSE }
  TEXTMODE;                     { RETURN APPLE SYSTEM TO TEXTMODE }
END.

